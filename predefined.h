/////////////////////////////////////////////////////////////////////////
//	  文件名：predefined.h	                                           //
//    用于数据预定义								     			   //
//必须注意的是，进行读操作之前，必须有一次空读操作，紧接着再读才会读出所要读的单元中的数据。                                                                    //
/////////////////////////////////////////////////////////////////////////

#define uchar unsigned char    //unsigned表示无符号
#define uint unsigned int

sbit RS=P2^6;  //定义12864液晶RS端,寄存器选择信号 H:数据寄存器 L:指令寄存器   
sbit RW=P2^5;  //定义12864液晶RW端,读/写信号  H:读  L:写   
sbit EN=P2^7;  //定义12864液晶LCDEN端, 片选信号  下降沿触发,锁存数据   
sbit LCD_PSB=P3^2;  //定义12864液晶PSB端, H:并行 L:串行  
sbit LCD_RST=P3^4;  //定义12864液晶RST端, H:不复位  L:复位

sbit key_up = P1^0;
sbit key_down=P1^1;
sbit key_left=P1^2;
sbit key_right=P1^3;
sbit key_a  =  P1^4;
sbit key_b  =  P1^5;
sbit count_step = P1^6;	  //上升沿数码管数字加1
sbit count_CR = P1^7;	  //CR=0数码管数字清零
sbit speaker=P2^0;

uchar tcount;  			//中断计数
uint Timtcount;			//计时变量（秒）
uchar playing;		//游戏标志
uchar n; 			//记录当前关卡
uchar man_x,man_y;		//纪录当前人物所在位置
uchar step;		//记录步数

uchar timer_h,timer_l,tt;
code uchar s1[]={ 1,0,1, 3,0,1, 5,0,2, 6,0,2, 4,0,1, 1,1,3 }; 	
code uchar s2[]={ 5,0,1, 4,0,2, 6,0,2, 4,0,1, 3,0,2, 2,0,2, 1,0,4 };
							 
// 音阶频率表 高八位
code unsigned char FREQH[]=
{
	0xF2,0xF3,0xF5,0xF5,0xF6,0xF7,0xF8,0xF9//1,2,3,4,5,6,7,8,i
};
// 音阶频率表 低八位
code unsigned char FREQL[]=
{
	0x42,0xC1,0x17,0xB6,0xD0,0xD1,0xB6,0x21//1,2,3,4,5,6,7,8,i
};


uchar code start[]=
{
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x10,0xA0,0x10,0x40,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x10,0x90,0x1F,0x7E,0x3F,0xF0,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x10,0x84,0x28,0xA0,0x00,0x10,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x11,0xFE,0x45,0x10,0x00,0x20,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0xFD,0x10,0x08,0x04,0x00,0x40,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x13,0x10,0x08,0xFE,0x01,0x80,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x15,0xFC,0xFE,0x84,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x19,0x10,0x08,0x84,0xFF,0xFE,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x31,0x10,0x18,0xFC,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0xD1,0xFC,0x1C,0x84,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x11,0x10,0x2A,0x84,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x11,0x10,0x28,0xFC,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x11,0x10,0x48,0x84,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x11,0xFE,0x88,0x84,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x51,0x00,0x08,0xFC,0x05,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x21,0x00,0x08,0x84,0x02,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,0xFF,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xCE,0xFF,0x38,0xC1,0xCE,0x0C,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x44,0x64,0x44,0x42,0x11,0x14,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA4,0x44,0x44,0x44,0x11,0x14,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA4,0x44,0x44,0x47,0x91,0x24,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xA4,0x44,0x44,0x44,0x51,0x44,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0xF4,0x44,0x44,0x44,0x51,0x7E,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x14,0x44,0x44,0x44,0x51,0x04,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x03,0xB3,0x8E,0x39,0xF3,0x8E,0x0C,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
      0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00
};

uchar code elements[][8]=
{
	0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,  //0空白
	0x3C,0x7E,0x66,0x3C,0x7E,0x99,0x3C,0x66,  //1人物
	0x7F,0x7F,0x7F,0x00,0xEF,0xEF,0xEF,0x00,  //2墙壁   0x7F,0x7F,0x7F,0x00,0xEF,0xEF,0xEF,0xEF,
	0xFF,0xC3,0xA5,0x99,0x99,0xA5,0xC3,0xFF,  //3箱子
	0x18,0x24,0x42,0x81,0x81,0x42,0x24,0x18,  //4目标
	0xFF,0xBD,0xDB,0xE7,0xE7,0xDB,0xBD,0xFF,  //5箱子到达目标
	0x3C,0x7E,0x7E,0xBD,0x7E,0x18,0x3C,0x66,  //6小人背面
	0x38,0x6C,0x38,0x9C,0x7C,0x9C,0x38,0x6C,  //7小人左面
	0x1C,0x36,0x1C,0x39,0x3E,0x39,0x1C,0x36,  //8小人右面	 	
};

/*********************************************
游戏关卡 一共9关
数字符号表示:人物1 砖头2 箱子3 目的4 成功5
**********************************************/
uchar code level[][8][8]=
{
	/*第1关*/
	2,2,2,2,2,2,2,2,
	2,0,0,0,0,0,1,2,
	2,0,0,0,5,0,0,2,
	2,0,0,2,2,2,2,2,
	2,2,0,0,2,0,0,0,
	2,0,3,0,2,0,0,0,
	2,0,0,4,2,0,0,0,
	2,2,2,2,2,0,0,0,
	
	/*第2关*/
	0,0,0,2,2,2,2,0,
	2,2,2,2,0,0,2,0,
	2,0,1,0,4,3,2,2,
	2,0,0,0,0,3,0,2,
	2,0,0,2,4,0,0,2,
	2,0,0,0,0,0,0,2,
	2,0,0,0,0,0,0,2,
	2,2,2,2,2,2,2,2,
	 
	/*第3关*/
	0,2,2,2,2,0,0,0,
	0,2,1,0,2,2,2,0,
	0,2,0,3,0,0,2,0,
	2,2,2,0,2,0,2,2,
	2,4,2,0,2,0,0,2,
	2,4,3,0,0,2,0,2,
	2,4,0,0,0,3,0,2,
	2,2,2,2,2,2,2,2,		
 
	/*第4关*/
	0,0,2,2,2,2,2,0,
	2,2,2,0,0,0,2,0,
	2,0,3,0,2,0,2,2,
	2,0,2,0,0,4,0,2,
	2,0,0,0,0,2,0,2,
	2,2,0,2,0,0,0,2,
	0,2,1,0,0,2,2,2,
	0,2,2,2,2,2,0,0, 	
 
	/*第5关*/
	0,0,2,2,2,2,2,2,
	0,0,2,0,0,0,0,2,
	2,2,2,3,3,3,0,2,
	2,1,0,3,4,4,0,2,
	2,0,3,4,4,4,2,2,
	2,2,2,2,0,0,2,0,
	0,0,0,2,2,0,2,0,
	0,0,0,0,2,2,2,0,

	/*第6关*/
	0,2,2,2,2,2,0,0,
	2,2,4,0,0,2,2,2,
	2,0,0,2,0,3,1,2,
	2,0,0,2,0,2,0,2,
	2,0,5,0,0,3,4,2,
	2,0,0,0,0,2,2,2,
	2,0,0,0,0,2,0,0,
	2,2,2,2,2,2,0,0,
	
	/*第7关*/
	0,2,2,2,2,0,0,0,
	2,2,0,0,2,0,0,0,
	2,1,3,0,2,0,0,0,
	2,2,3,0,2,2,0,0,
	2,2,0,3,0,2,0,0,
	2,4,3,0,0,2,0,0,
	2,4,4,5,4,2,0,0,
	2,2,2,2,2,2,0,0, 	
	
	/*第8关*/
	0,0,2,2,2,2,2,0,
	2,2,2,0,0,0,2,0,
	2,0,3,0,2,0,2,2,
	2,0,2,0,0,4,0,2,
	2,0,0,0,0,2,0,2,
	2,2,3,2,4,0,0,2,
	0,2,1,0,0,2,2,2,
	0,2,2,2,2,2,0,0,
 
	/*第9关*/
	0,0,2,2,2,2,0,0,
	0,0,2,4,4,2,0,0,
	0,2,2,0,4,2,2,0,
	0,2,0,0,3,4,2,0,
	2,2,0,3,0,0,2,2,
	2,0,0,2,3,3,0,2,
	2,0,0,1,0,0,0,2,
	2,2,2,2,2,2,2,2,	
};

//记录当前的游戏界面的变化
uchar xdata level_temp[8][8]=	  //code内存换data内存			
{
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
	0,0,0,0,0,0,0,0,
};

/**
	uint i;
	unsigned char *addr;
	lcd_init(); 
	while(1)
	{
	lcd_pos(1,1);
	addr = elements[1]; 
	for(i=0;i<32;i++)
	{
		lcd_write_dat(*addr++);
		lcd_write_cmd(0xc0);
	}
	delay(500);  
	}
 **/